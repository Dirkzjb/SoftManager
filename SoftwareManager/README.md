# 内网软件管理系统

## 项目概述

内网软件管理系统是一个基于 WinForms 开发的桌面应用程序，用于管理和安装内网环境中的软件。系统根据配置文件动态生成软件类别标签页，展示软件列表，并通过检查注册表判断软件安装状态。系统包含初始化配置和软件安装两个主要页签。

## 主要功能

- **初始化配置**：设置远程配置文件URL
- **软件安装**：管理和安装软件
- **动态标签页**：根据配置文件中的软件类别自动生成标签页
- **软件列表**：清晰展示软件名称、说明和安装状态
- **安装状态检测**：通过注册表检查软件是否已安装
- **安装包检查**：检查指定目录中的安装包是否存在
- **搜索功能**：支持在当前标签页中搜索软件
- **刷新功能**：重新检查软件安装状态

## 技术架构

- **开发环境**：Visual Studio 2022
- **目标框架**：.NET 8.0
- **UI框架**：Windows Forms
- **数据存储**：JSON配置文件
- **安装状态检测**：Windows注册表API

## 项目结构

- **Models/**：数据模型类
  - `SoftwareCategory.cs`：软件类别模型
  - `Software.cs`：软件项模型
  - `SoftwareData.cs`：软件数据模型
- **Forms/**：窗体和控件
  - `MainForm.cs`：主窗体
  - `SoftwareItemControl.cs`：软件项控件
  - `InitializePanel.cs`：初始化配置面板
  - `TabForm.cs`：标签切换控件
- **Utils/**：工具类
  - `RegistryHelper.cs`：注册表操作工具
  - `FileHelper.cs`：文件操作工具
  - `DataManager.cs`：数据管理工具

## 如何使用

### 运行应用程序

1. 确保已安装 .NET 6.0 运行时环境
2. 双击 `Run.bat` 脚本运行应用程序
3. 或者直接运行 `bin\Release\net6.0-windows\SoftwareManager.exe`

### 首次使用

1. 首次运行时，系统会显示初始化配置面板
2. 输入远程配置文件URL（如有）
3. 点击"保存"按钮完成配置

### 日常使用

1. 通过顶部标签切换"初始化配置"和"软件安装"页面
2. 在"软件安装"页面：
   - 通过标签页切换不同类别的软件
   - 使用搜索框搜索当前标签页中的软件
   - 点击刷新按钮重新检查软件安装状态
   - 对于未安装的软件：
     - 如果安装包存在，点击"安装"按钮启动安装程序
     - 如果安装包不存在，点击"下载"按钮打开下载链接

## 配置文件格式

```json
{
  "Categories": [
    {
      "Name": "类别名称",
      "Software": [
        {
          "Name": "软件名称",
          "Description": "软件说明",
          "Installed": false,
          "RegistryPath": "注册表路径",
          "InstallPackagePath": "安装包路径",
          "DownloadUrl": "下载链接"
        }
      ]
    }
  ]
}
```

## 开发者指南

### 编译项目

1. 使用 Visual Studio 2022 打开 `SoftwareManager.csproj`
2. 或者运行 `PublishSimple.bat` 脚本编译项目

### 修改配置

1. 编辑 `config.json` 文件，添加或修改软件类别和软件项
2. 重启应用程序使修改生效

## 许可证

本项目采用 MIT 许可证